<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>CreditoSintesiJoselito</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="assets/fontawesome/css/all.min.css">
</head>
<body>

    <header></header>

    <div class="wrapper4">
        <section>

            <h3>CÃ³digo Arduino</h3>

            <p></p>

            <p>A continuacion se expone el codigo de uno de nuestros ultimos talleres</p>

            <p>Todo nuestro codigo fue creado desde 0 por nosotros con informacion sacada de repositorios github de otros usuarios, paginas web, youtube, etc...</p>

            <p>
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">//*******************************************************************************</span>
<span style="color: #888888">/*</span>
<span style="color: #888888">keyestudio 4wd BT Car </span>
<span style="color: #888888">lesson 14</span>
<span style="color: #888888">IR remote Control Car</span>
<span style="color: #888888">http://www.keyestudio.com</span>
<span style="color: #888888">*/</span> 
<span style="color: #557799">#define SCL_Pin  A5  </span><span style="color: #888888">//Set the clock pin to A5</span>
<span style="color: #557799">#define SDA_Pin  A4  </span><span style="color: #888888">//Set data pin to A4</span>
<span style="color: #888888">//Array, used to store the data of pattern, can be calculated by yourself or obtained from the modulus tool</span>
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> start01[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0x01</span>,<span style="color: #005588; font-weight: bold">0x02</span>,<span style="color: #005588; font-weight: bold">0x04</span>,<span style="color: #005588; font-weight: bold">0x08</span>,<span style="color: #005588; font-weight: bold">0x10</span>,<span style="color: #005588; font-weight: bold">0x20</span>,<span style="color: #005588; font-weight: bold">0x40</span>,<span style="color: #005588; font-weight: bold">0x80</span>,<span style="color: #005588; font-weight: bold">0x80</span>,<span style="color: #005588; font-weight: bold">0x40</span>,<span style="color: #005588; font-weight: bold">0x20</span>,<span style="color: #005588; font-weight: bold">0x10</span>,<span style="color: #005588; font-weight: bold">0x08</span>,<span style="color: #005588; font-weight: bold">0x04</span>,<span style="color: #005588; font-weight: bold">0x02</span>,<span style="color: #005588; font-weight: bold">0x01</span>};
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> front[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x24</span>,<span style="color: #005588; font-weight: bold">0x12</span>,<span style="color: #005588; font-weight: bold">0x09</span>,<span style="color: #005588; font-weight: bold">0x12</span>,<span style="color: #005588; font-weight: bold">0x24</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>};
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> back[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x24</span>,<span style="color: #005588; font-weight: bold">0x48</span>,<span style="color: #005588; font-weight: bold">0x90</span>,<span style="color: #005588; font-weight: bold">0x48</span>,<span style="color: #005588; font-weight: bold">0x24</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>};
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> left[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0xbc</span>, <span style="color: #005588; font-weight: bold">0x9a</span>, <span style="color: #005588; font-weight: bold">0x9a</span>, <span style="color: #005588; font-weight: bold">0xda</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x24</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x64</span>, <span style="color: #005588; font-weight: bold">0x3c</span>};
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> right[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0x1c</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0x22</span>, <span style="color: #005588; font-weight: bold">0xe6</span>, <span style="color: #005588; font-weight: bold">0x9b</span>, <span style="color: #005588; font-weight: bold">0x99</span>, <span style="color: #005588; font-weight: bold">0xff</span>, <span style="color: #005588; font-weight: bold">0x00</span>};
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> STOP01[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0x7e</span>, <span style="color: #005588; font-weight: bold">0x42</span>, <span style="color: #005588; font-weight: bold">0x42</span>, <span style="color: #005588; font-weight: bold">0x3c</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7e</span>, <span style="color: #005588; font-weight: bold">0x0a</span>, <span style="color: #005588; font-weight: bold">0x1a</span>, <span style="color: #005588; font-weight: bold">0x6e</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7e</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7e</span>, <span style="color: #005588; font-weight: bold">0x0a</span>, <span style="color: #005588; font-weight: bold">0x0a</span>, <span style="color: #005588; font-weight: bold">0x0e</span>};
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> clear[] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>,<span style="color: #005588; font-weight: bold">0x00</span>};

<span style="color: #557799">#include &lt;Arduino.h&gt;</span>
<span style="color: #557799">#include &lt;IRremote.h&gt;</span><span style="color: #888888">//function library of IR remote control</span>
<span style="color: #333399; font-weight: bold">int</span> RECV_PIN <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">3</span>;<span style="color: #888888">//set the pin of IR receiver to D3</span>
IRrecv <span style="color: #0066BB; font-weight: bold">irrecv</span>(RECV_PIN);
<span style="color: #333399; font-weight: bold">long</span> irr_val;
decode_results results;

<span style="color: #333399; font-weight: bold">int</span> left_ctrl <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">2</span>;<span style="color: #888888">//define the direction control pins of group B motor</span>
<span style="color: #333399; font-weight: bold">int</span> left_pwm <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">5</span>;<span style="color: #888888">//define the PWM control pins of group B motor</span>
<span style="color: #333399; font-weight: bold">int</span> right_ctrl <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">4</span>;<span style="color: #888888">//define the direction control pins of group A motor</span>
<span style="color: #333399; font-weight: bold">int</span> right_pwm <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">6</span>;<span style="color: #888888">//define the PWM control pins of group A motor</span>

<span style="color: #557799">#include &lt;Servo.h&gt;</span>
Servo servo_A3;<span style="color: #888888">//set the pin of servo to A3 </span>

<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> data_line <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>;
<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> delay_count <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>;

boolean mode_auto <span style="color: #333333">=</span> <span style="color: #007020">false</span>; 

<span style="color: #557799">#include &quot;SR04.h&quot;</span><span style="color: #888888">//define the library of ultrasonic sensor</span>
<span style="color: #557799">#define TRIG_PIN 12</span><span style="color: #888888">// set the signal output of ultrasonic sensor to D12 </span>
<span style="color: #557799">#define ECHO_PIN 13</span><span style="color: #888888">//set the signal input of ultrasonic sensor to D13 </span>
SR04 sr04 <span style="color: #333333">=</span> SR04(ECHO_PIN,TRIG_PIN);
<span style="color: #333399; font-weight: bold">long</span> distance,a1,a2;<span style="color: #888888">//define three distance</span>
<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> servopin <span style="color: #333333">=</span> A3;<span style="color: #888888">//set the pin of servo to A3 </span>



<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">setup</span>() {
  Serial.begin(<span style="color: #0000DD; font-weight: bold">9600</span>);<span style="color: #888888">//</span>
  <span style="color: #888888">// In case the interrupt driver crashes on setup, give a clue</span>
  <span style="color: #888888">// to the user what&#39;s going on.</span>
  Serial.println(<span style="background-color: #fff0f0">&quot;Enabling IRin&quot;</span>);
  irrecv.enableIRIn(); <span style="color: #888888">// Start the receiver</span>
  Serial.println(<span style="background-color: #fff0f0">&quot;Enabled IRin&quot;</span>);
  pinMode(left_ctrl,OUTPUT);<span style="color: #888888">//set direction control pins of group B motor to OUTPUT</span>
  pinMode(left_pwm,OUTPUT);<span style="color: #888888">//set PWM control pins of group B motor to OUTPUT</span>
  pinMode(right_ctrl,OUTPUT);<span style="color: #888888">//set direction control pins of group A motor to OUTPUT</span>
  pinMode(right_pwm,OUTPUT);<span style="color: #888888">//set PWM control pins of group A motor to OUTPUT</span>
  servo_A3.attach(A3);
  servo_A3.write(<span style="color: #0000DD; font-weight: bold">90</span>);<span style="color: #888888">//the angle of servo is 90 degree</span>
  delay(<span style="color: #0000DD; font-weight: bold">300</span>);
  pinMode(SCL_Pin,OUTPUT);<span style="color: #888888">// Set the clock pin to output</span>
  pinMode(SDA_Pin,OUTPUT);<span style="color: #888888">//Set the data pin to output</span>
  matrix_display(clear);
  matrix_display(start01); <span style="color: #888888">//display start01 expression pattern</span>
}

<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">loop</span>() {

  
  <span style="color: #008800; font-weight: bold">if</span> (irrecv.decode(<span style="color: #333333">&amp;</span>results)) {
    irr_val <span style="color: #333333">=</span> results.value;
    Serial.println(<span style="background-color: #fff0f0">&quot;BOTON:&quot;</span>);
    Serial.println(irr_val, HEX);<span style="color: #888888">//serial prints the read IR remote signals </span>


    
    <span style="color: #008800; font-weight: bold">switch</span>(irr_val)
    {

<span style="color: #888888">// * FF42BD</span>
<span style="color: #888888">// # FF52AD</span>

      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFF42BD</span> : mode_auto <span style="color: #333333">=</span> <span style="color: #007020">true</span>;
            <span style="color: #008800; font-weight: bold">break</span>;
  
      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFF52AD</span> : mode_auto <span style="color: #333333">=</span> <span style="color: #007020">false</span>;
            <span style="color: #008800; font-weight: bold">break</span>;
        
      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFF629D</span> : car_front(); <span style="color: #888888">//Receive 0xFF629D,the car goes forward</span>
      matrix_display(clear);
      matrix_display(front);   
      <span style="color: #008800; font-weight: bold">break</span>;
      
      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFFA857</span> : car_back(); <span style="color: #888888">//Receive 0xFFA857,the car goes back</span>
      matrix_display(clear);
      matrix_display(back); 
      <span style="color: #008800; font-weight: bold">break</span>;

      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFF22DD</span> : car_left(); <span style="color: #888888">//Receive 0xFF22DD,the car left rotates</span>
      matrix_display(clear);
      matrix_display(left); 
      <span style="color: #008800; font-weight: bold">break</span>;
     
      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFFC23D</span> : car_right();<span style="color: #888888">//Receive 0xFFC23D,the car right rotates</span>
      matrix_display(clear);
      matrix_display(right);  
      <span style="color: #008800; font-weight: bold">break</span>;
     
      <span style="color: #008800; font-weight: bold">case</span> <span style="color: #005588; font-weight: bold">0xFF02FD</span> : car_Stop();<span style="color: #888888">//Receive 0xFF02FD,the car stops</span>
      matrix_display(clear);
      matrix_display(STOP01); 
      <span style="color: #008800; font-weight: bold">break</span>;
    }
        irrecv.resume(); <span style="color: #888888">// Receive the next value</span>
  }

  
   <span style="color: #008800; font-weight: bold">if</span> (mode_auto) {
      avoid(); 
   } 
}


<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">avoid</span>()
{
  distance<span style="color: #333333">=</span>sr04.Distance(); <span style="color: #888888">//obtain the value detected by ultrasonic sensor </span>

  <span style="color: #008800; font-weight: bold">if</span>((distance <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">20</span>)<span style="color: #333333">&amp;&amp;</span>(distance <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">0</span>))<span style="color: #888888">//if the distance is greater than 0 and less than 10  </span>

  {
    car_Stop();<span style="color: #888888">//stop</span>
    matrix_display(clear);
    matrix_display(STOP01);<span style="color: #888888">//show stop pattern</span>
    delay(<span style="color: #0000DD; font-weight: bold">1000</span>);
    servopulse(servopin,<span style="color: #0000DD; font-weight: bold">160</span>);<span style="color: #888888">//servo rotates to 160Â°</span>
    delay(<span style="color: #0000DD; font-weight: bold">500</span>);
    a1<span style="color: #333333">=</span>sr04.Distance();<span style="color: #888888">//measure the distance</span>
    delay(<span style="color: #0000DD; font-weight: bold">100</span>);
    servopulse(servopin,<span style="color: #0000DD; font-weight: bold">20</span>);<span style="color: #888888">//rotate to 20 degree</span>
    delay(<span style="color: #0000DD; font-weight: bold">500</span>);
    a2<span style="color: #333333">=</span>sr04.Distance();<span style="color: #888888">//measure the distance</span>
    delay(<span style="color: #0000DD; font-weight: bold">100</span>);
    servopulse(servopin,<span style="color: #0000DD; font-weight: bold">90</span>);  <span style="color: #888888">//Return to the 90 degree position</span>
    delay(<span style="color: #0000DD; font-weight: bold">500</span>);
    <span style="color: #008800; font-weight: bold">if</span>(a1 <span style="color: #333333">&gt;</span> a2)<span style="color: #888888">//compare the distance, if left distance is more than right distance</span>
    {
      car_left();<span style="color: #888888">//turn left</span>
      matrix_display(clear);
      matrix_display(left);    <span style="color: #888888">//display left-turning pattern</span>
      servopulse(servopin,<span style="color: #0000DD; font-weight: bold">90</span>);<span style="color: #888888">//servo rotates to 90 degree</span>
      delay(<span style="color: #0000DD; font-weight: bold">700</span>); <span style="color: #888888">//turn left 700ms</span>
      matrix_display(clear);
      matrix_display(front);  <span style="color: #888888">//show forward pattern</span>
    }
    <span style="color: #008800; font-weight: bold">else</span><span style="color: #888888">//if the right distance is greater than the left</span>
    {
      car_right();<span style="color: #888888">//turn right</span>
      matrix_display(clear);
      matrix_display(right);  <span style="color: #888888">//display right-turning pattern</span>
      servopulse(servopin,<span style="color: #0000DD; font-weight: bold">90</span>);<span style="color: #888888">//servo rotates to 90 degree</span>
      delay(<span style="color: #0000DD; font-weight: bold">700</span>);
      matrix_display(clear);
      matrix_display(front);  <span style="color: #888888">//show forward pattern</span>
    }
  }
  <span style="color: #008800; font-weight: bold">else</span><span style="color: #888888">//otherwise</span>
  {
    car_front();<span style="color: #888888">//go forward</span>
    matrix_display(clear);
    matrix_display(front);  <span style="color: #888888">// show forward pattern</span>
  }
}


<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">car_front</span>()<span style="color: #888888">//define the state of going front</span>
{
  digitalWrite(left_ctrl,HIGH);
  analogWrite(left_pwm,<span style="color: #0000DD; font-weight: bold">105</span>);
  digitalWrite(right_ctrl,HIGH);
  analogWrite(right_pwm,<span style="color: #0000DD; font-weight: bold">105</span>);
}
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">car_back</span>()<span style="color: #888888">//define the status of going back</span>
{
  digitalWrite(left_ctrl,LOW);
  analogWrite(left_pwm,<span style="color: #0000DD; font-weight: bold">150</span>);
  digitalWrite(right_ctrl,LOW);
  analogWrite(right_pwm,<span style="color: #0000DD; font-weight: bold">150</span>);
}
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">car_left</span>()<span style="color: #888888">//set the status of left turning</span>
{
  digitalWrite(left_ctrl, LOW);
  analogWrite(left_pwm, <span style="color: #0000DD; font-weight: bold">100</span>);  
  digitalWrite(right_ctrl, HIGH);
  analogWrite(right_pwm, <span style="color: #0000DD; font-weight: bold">155</span>);
}
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">car_right</span>()<span style="color: #888888">//set the status of right turning</span>
{
  digitalWrite(left_ctrl, HIGH);
  analogWrite(left_pwm, <span style="color: #0000DD; font-weight: bold">155</span>);
  digitalWrite(right_ctrl, LOW);
  analogWrite(right_pwm, <span style="color: #0000DD; font-weight: bold">100</span>);
}
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">car_Stop</span>()<span style="color: #888888">//define the state of stop</span>
{
  digitalWrite(left_ctrl,LOW);
  analogWrite(left_pwm,<span style="color: #0000DD; font-weight: bold">0</span>);
  digitalWrite(right_ctrl,LOW);
  analogWrite(right_pwm,<span style="color: #0000DD; font-weight: bold">0</span>);
}

<span style="color: #888888">//this function is used for dot matrix display</span>
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">matrix_display</span>(<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> matrix_value[])
{
  IIC_start();  <span style="color: #888888">//the function that calls the data transfer start condition</span>
  IIC_send(<span style="color: #005588; font-weight: bold">0xc0</span>);  <span style="color: #888888">//select address</span>

  <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">16</span>; i<span style="color: #333333">++</span>) <span style="color: #888888">//the pattern data is 16 bytes</span>
  {
    IIC_send(matrix_value[i]); <span style="color: #888888">//Transmit the data of the pattern</span>
  }
  IIC_end();   <span style="color: #888888">//End pattern data transmission</span>
  IIC_start();
  IIC_send(<span style="color: #005588; font-weight: bold">0x8A</span>);  <span style="color: #888888">//Display control, select 4/16 pulse width</span>
  IIC_end();
}
<span style="color: #888888">//Conditions under which data transmission begins</span>
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">IIC_start</span>()
{
  digitalWrite(SDA_Pin, HIGH);
  digitalWrite(SCL_Pin, HIGH);
  delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
  digitalWrite(SDA_Pin, LOW);
  delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
  digitalWrite(SCL_Pin, LOW);
}
<span style="color: #888888">//Indicates the end of data transmission</span>
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">IIC_end</span>()
{
  digitalWrite(SCL_Pin, LOW);
  digitalWrite(SDA_Pin, LOW);
  delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
  digitalWrite(SCL_Pin, HIGH);
  delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
  digitalWrite(SDA_Pin, HIGH);
  delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
}
<span style="color: #888888">//transmit data</span>
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">IIC_send</span>(<span style="color: #333399; font-weight: bold">unsigned</span> <span style="color: #333399; font-weight: bold">char</span> send_data)
{
  <span style="color: #008800; font-weight: bold">for</span> (byte mask <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0x01</span>; mask <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">0</span>; mask <span style="color: #333333">&lt;&lt;=</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #888888">//Each byte has 8 bits and is checked bit by bit starting at the lowest level</span>
  {
    <span style="color: #008800; font-weight: bold">if</span> (send_data <span style="color: #333333">&amp;</span> mask) { <span style="color: #888888">//Sets the high and low levels of SDA_Pin depending on whether each bit of the byte is a 1 or a 0</span>
      digitalWrite(SDA_Pin, HIGH);
    } <span style="color: #008800; font-weight: bold">else</span> {
      digitalWrite(SDA_Pin, LOW);
    }
    delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
    digitalWrite(SCL_Pin, HIGH); <span style="color: #888888">//Pull the clock pin SCL_Pin high to stop data transmission</span>
    delayMicroseconds(<span style="color: #0000DD; font-weight: bold">3</span>);
    digitalWrite(SCL_Pin, LOW); <span style="color: #888888">//pull the clock pin SCL_Pin low to change the SIGNAL of SDA </span>
  }
}
<span style="color: #888888">//*******************************************************************************</span>


<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">servopulse</span>(<span style="color: #333399; font-weight: bold">int</span> servopin,<span style="color: #333399; font-weight: bold">int</span> myangle)<span style="color: #888888">//the running angle of servo</span>
{
  <span style="color: #008800; font-weight: bold">for</span>(<span style="color: #333399; font-weight: bold">int</span> i<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span>; i<span style="color: #333333">&lt;</span><span style="color: #0000DD; font-weight: bold">20</span>; i<span style="color: #333333">++</span>)
  {
    <span style="color: #333399; font-weight: bold">int</span> pulsewidth <span style="color: #333333">=</span> (myangle<span style="color: #333333">*</span><span style="color: #0000DD; font-weight: bold">11</span>)<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">500</span>;
    digitalWrite(servopin,HIGH);
    delayMicroseconds(pulsewidth);
    digitalWrite(servopin,LOW);
    delay(<span style="color: #0000DD; font-weight: bold">20</span><span style="color: #333333">-</span>pulsewidth<span style="color: #333333">/</span><span style="color: #0000DD; font-weight: bold">1000</span>);
  } 
}
</pre></div>

            </p>
        </section>
    </div>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="script.js"></script>


</body>
</html>